<!doctype html>
<title>RolleiVision MSC Remote</title>
<meta charset=utf-8>
<meta name=viewport content="width=device-width, user-scalable=no">
<link href="/static/favicon.ico" rel="icon" type="image/x-icon">
<style>
  body {
    font-family: monospace;
    background: white;
    color: #565656;
  }
  .dark {
    background: black;
    -webkit-filter: invert(1) hue-rotate(160deg) saturate(1.2) brightness(1.1);
  }
  #error, #res {
    font-size: 70%;
  }
  #error {
    color: red;
    background:  #fbe3e4;
    font-weight: bold;
  }
  .big {
    font-size: 350%;
  }
  .right {
    text-align: right;
  }
  .left {
    text-align: left;
  }
  .centered {
    text-align: center;
  }
  table {
    margin-left: auto;
    margin-right: auto;
  }
  td {
    text-align: center;
    /* baseline, sub, super, top, text-top, middle,
     * bottom, text-bottom, length, or a value in percentage
     */
    vertical-align: middle;
    padding: 0 10px 0 10px;
  }
  output, label {
    vertical-align: middle;
    width: 25%;
  }
  #xhr_poll_status, #projector_status {
    font-size: 75%;
    cursor: pointer;
  }
  #xhr_poll_status #xhr_poll_status_off, #projector_status_offline {
    font-weight: bold;
    color: #FF0000;
  }
  #xhr_poll_status #xhr_poll_status_on, #projector_status_online {
    font-weight: bold;
    color: #00FF00;
  }
  hr {
    border: 1px solid #dedede;
    border-bottom: none;
    margin: 10px 0 10px 0;
  }
  button, input[type='submit'] {
    height: 70px;
    width: 100%;
    font-family: monospace;
    display: block;
    padding: 0;
    background: #f5f5f5;
    border: 1px solid #dedede;
    border-top: 1px solid #eee;
    border-left: 1px solid #eee;
    color: #565656;
    /*
     * transition: background .25s ease-in-out;
     * -moz-transition: background .25s ease-in-out;
     * -webkit-transition: background .25s ease-in-out;
     */
  }
  button img {
    margin:0 3px -3px 0 !important;
    padding:0;
    border:none;
    width:16px;
    height:16px;
  }
  button:hover, input[type='submit']:hover {
    color: #336699;
    background: #dff4ff;
    border: 1px solid #c2e1ef;
  }
  button.positive:hover {
    color: #529214;
    background: #E6EFC2;
    border: 1px solid #C6D880;
  }
  button.on, button.on:hover {
    color: #d12f19;
    background: #fbe3e4;
    border: 1px solid #fbc2c4;
  }
  button.big.on, button.big.on:hover {
    color: #bb7c16;
    background: #f9e6c8;
    border: 1px solid #e5991f;
  }
  .bulbglow {
    display: none;
  }
  button.on .bulbglow {
    display: block;
  }
  input[type='range'] {
    width: 90%;
  }
  button, input, textarea, select {
    -webkit-box-shadow: 1px 1px 1px #eee;
    -webkit-border-radius: 3px;
  }
  input[type='number'] {
    height: 38px;
    width: 50px;
    vertical-align: middle;
    font-family: monospace;
    font-size: 200%;
    padding-left: 5px;
    background: #f5f5f5;
    border: 1px solid #fff;
    color: #565656;
    -webkit-box-shadow:inset 2px 2px 6px #aaa;
    -webkit-border-radius: 6px;
  }
  input[type='submit'] {
    display: inline;
    width: 40%;
    height: 40px;
  }
  .green {
    background: green;
  }
  #shortcuthelp {
    font-size: 80%;
    padding: 12px;
    left: 50%;
    top: 50%;
    margin: -350px 0 0 -150px;
    width: 300px;
    z-index: 1002;
    color: #FFF;
    position: fixed;
    text-align: center;
    font-weight: bold;
    background: #222 none repeat scroll 0;
    overflow: hidden;
    opacity: .85;
    border-radius: 10px;
  }
  #shortcuthelp td.right {
    color: yellow;
  }
  .hidden {
    display: none;
    visibility: hidden;
  }
</style>

<script src=/static/xhr.js></script>
<script src=/static/mousetrap.min.js></script>
<script>
  var submit = function(args, origin) {
    XHR.get('/rolleicom', args, function(x, r) {
      var success = r.response[0],
          value = r.response[1],
          status = r.response[2];
      var res = document.getElementById('res');
      var err = document.getElementById('error');
      if (success) {
        res.innerHTML = status + ' response';
        err.innerHTML = '';
      } else {
        err.innerHTML = 'error: ' + status;
        res.innerHTML = '';
      }
      if (typeof(value) === 'boolean') {
        if (value === true) {
          origin.classList.add('on');
        } else {
          origin.classList.remove('on');
        }
      }
    });
  };

  function formsend(form) {
    var query = {};
    for (var n = 0; n < form.elements.length; n++) {
      var field = form.elements[n];
      if (!field.hasAttribute("name")
          || (/^(?:radio|checkbox)$/.test(field.type)
              && !field.checked)) {
                continue;
              }
      if (field.type === "number" && isNaN(parseFloat(field.value))) {
        continue;
      }
      query[escape(field.getAttribute("name"))] = escape(field.value);
    }
    if (Object.keys(query).length > 0) {
      query['action'] = form.name;
      submit(query);
    }
  }

  var throttle = function(func, wait) {
    var timeout;
    return function() {
      var context = this, args = arguments;
      if (!timeout) {
        // the first time the event fires, we setup a timer, which
        // is used as a guard to block subsequent calls; once the
        // timer's handler fires, we reset it and create a new one
        timeout = setTimeout(function() {
          timeout = null;
          func.apply(context, args);
        }, wait);
      }
    };
  };

  function toggleDark() {
      document.body.classList.toggle('dark');
  }

  var toggleLamps = function(origin) {
    XHR.get('/rolleicom', {'action': 'querylamps'}, function(x, r) {
      var emitting = r.response[1];
      if (emitting) {
        submit({'action': 'lampcontrol', 'wait': true}, origin)
        origin.classList.remove('on');
      } else {
        submit({'action': 'lampcontrol', 'left': 1, 'right': 1}, origin)
        origin.classList.add('on');
      }
    });
  };
  var setLeftBrightness = function(value) {
    submit({'action': 'brightnessleft', 'brightness': value}, this);
    document.getElementById('bleftvalue').value = ('\xA0\xA0\xA0\xA0\xA0' + (value / 255 * 100).toFixed(1)).slice(-5);
  };

  var setRightBrightness = function(value) {
    submit({'action': 'brightnessright', 'brightness': value}, this);
    document.getElementById('brightvalue').value = ('\xA0\xA0\xA0\xA0\xA0' + (value / 255 * 100).toFixed(1)).slice(-5);
  };

  var setDissolveTime = function(value) {
    submit({'action': 'dissolvefor', 'duration': value}, this);
    document.getElementById('dissolvevalue').value = ('\xA0\xA0\xA0' + (value / 10).toFixed(1)).slice(-5) + ' Sek.';
  };

  var checkConnection = function() {
    XHR.poll(5, '/rolleicom', {'action': 'connected'}, function(x, r) {
      var response = r.response;
      if (response) {
        document.getElementById('projector_status_online').style.display = '';
        document.getElementById('projector_status_offline').style.display = 'none';
      } else {
        document.getElementById('projector_status_online').style.display = 'none';
        document.getElementById('projector_status_offline').style.display = '';
      }
    });
  };

  var pollStatus = function() {
    XHR.poll(1, '/rolleicom', {'action': 'getstatus', 'verbose': true}, function(x, r) {
      document.getElementById('res').innerHTML = r.response + ' now';
    });
  };

  Mousetrap.bind(['?'], function(e) {
    document.getElementById('shortcuthelp').classList.toggle('hidden');
    return false;
  });

  Mousetrap.bind(['<'], function(e) {
    submit({'action': 'next'}, document.getElementById('forward'))
    return false;
  });

  Mousetrap.bind(['<'], function(e) {
    submit({'action': 'next'})
    return false;
  });

  Mousetrap.bind(['>'], function(e) {
    submit({'action': 'previous'})
    return false;
  });

  Mousetrap.bind(['e'], function(e) {
    submit({'action': 'end'})
    return false;
  });

  Mousetrap.bind(['r'], function(e) {
    submit({'action': 'reset'})
    return false;
  });

  Mousetrap.bind(['p'], function(e) {
    submit({'action': 'togglePC'}, document.getElementById('pcmode') )
    return false;
  });

  Mousetrap.bind(['s'], function(e) {
    submit({'action': 'togglestop'})
    return false;
  });

  Mousetrap.bind(['+'], function(e) {
    submit({'action': 'focusin'})
    return false;
  });

  Mousetrap.bind(['-'], function(e) {
    submit({'action': 'focusout'})
    return false;
  });

  Mousetrap.bind(['h'], function(e) {
    var element = document.getElementById('bleftinput');
    element.stepDown(10)
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent("change", false, true);
    element.dispatchEvent(evt)
    return false;
  });

  Mousetrap.bind(['j'], function(e) {
    var element = document.getElementById('bleftinput');
    element.stepUp(10)
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent("change", false, true);
    element.dispatchEvent(evt)
    return false;
  });

  Mousetrap.bind(['k'], function(e) {
    var element = document.getElementById('brightinput');
    element.stepDown(10)
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent("change", false, true);
    element.dispatchEvent(evt)
    return false;
  });

  Mousetrap.bind(['l'], function(e) {
    var element = document.getElementById('brightinput');
    element.stepUp(10)
    var evt = document.createEvent("HTMLEvents");
    evt.initEvent("change", false, true);
    element.dispatchEvent(evt)
    return false;
  });


  Mousetrap.bind(['1'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:200'});
    document.getElementById('leftlamp').classList.add('on');
  });

  Mousetrap.bind(['2'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:201'});
    document.getElementById('rightlamp').classList.add('on');
  });

  Mousetrap.bind(['3'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:202'});
    document.getElementById('leftlamp').classList.remove('on');
  });

  Mousetrap.bind(['4'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:203'});
    document.getElementById('rightlamp').classList.remove('on');
  });

  Mousetrap.bind(['5'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:204'});
    document.getElementById('leftlamp').classList.add('on');
    document.getElementById('rightlamp').classList.remove('on');
  });

  Mousetrap.bind(['6'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:205'});
    document.getElementById('rightlamp').classList.add('on');
    document.getElementById('leftlamp').classList.remove('on');
  });

  Mousetrap.bind(['7'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:206'});
    document.getElementById('leftlamp').classList.add('on');
    document.getElementById('rightlamp').classList.add('on');
  });

  Mousetrap.bind(['8'], function(e) {
    submit({'action': 'submit', 'cmd': 'LM:207'});
    document.getElementById('leftlamp').classList.remove('on');
    document.getElementById('rightlamp').classList.remove('on');
  });

  // Suspend XHR requests when tab is not visible
  (function() {
    var hidden = "hidden";

    if (hidden in document)
      document.addEventListener("visibilitychange", onchange);
    else if ((hidden = "mozHidden") in document)
      document.addEventListener("mozvisibilitychange", onchange);
    else if ((hidden = "webkitHidden") in document)
      document.addEventListener("webkitvisibilitychange", onchange);

    function onchange(evt) {
      if (document[hidden]) {
        XHR.halt();
      } else {
        XHR.run();
      }
    }
  })();

  window.onload = function() {
    var bleft = document.getElementById('bleftinput'),
    bright = document.getElementById('brightinput'),
    lleft = document.getElementById('lleftinput'),
    lright = document.getElementById('lrightinput'),
    dissolve = document.getElementById('dissolveinput'),
    pcmode = document.getElementById('pcmode'),
    stopgo = document.getElementById('stopgo'),
    autofocus = document.getElementById('autofocus');
    lamps = document.getElementById('lamps');

    bleft.addEventListener('change', throttle(function() {
      setLeftBrightness(bleft.value)}, 50), false);
    bright.addEventListener('change', throttle(function() {
      setRightBrightness(bright.value)}, 50), false);
    dissolve.addEventListener('change', throttle(function() {
      setDissolveTime(dissolve.value)}, 250), false);

    var initStopped = function() {
      XHR.get('/rolleicom', {'action': 'querystopped'}, function(x, r) {
        var value = r.response[1];
        if (value === true) {
          stopgo.classList.add('on');
        } else {
          stopgo.classList.remove('on');
        }
        //checkConnection();
        //pollStatus();
      });
    };
    var initPCmode = function() {
      XHR.get('/rolleicom', {'action': 'queryPCmode'}, function(x, r) {
        var value = r.response[1];
        if (value === true) {
          pcmode.classList.add('on');
        } else {
          pcmode.classList.remove('on');
        }
        initStopped();
      });
    };
    var initAF = function() {
      XHR.get('/rolleicom', {'action': 'queryAF'}, function(x, r) {
        var value = r.response[1];
        if (value === true) {
          autofocus.classList.add('on');
        } else {
          autofocus.classList.remove('on');
        }
        initPCmode();
      });
    };
    var initLamps = function() {
      XHR.get('/rolleicom', {'action': 'querylamps'}, function(x, r) {
        var value = r.response[1];
        if (value === true) {
          lamps.classList.add('on');
        } else {
          lamps.classList.remove('on');
        }
        initAF();
      });
    };
    var initDissolve = function() {
      XHR.get('/rolleicom', {'action': 'querydissolve'}, function(x, r) {
        var success = r.response[0], value = r.response[1], status = r.response[2];
        if (success) {
          dissolve.value = value;
          document.getElementById('dissolvevalue').value = ('\xA0\xA0\xA0' + (value / 10).toFixed(1)).slice(-5) + ' Sek.';
        }
        initLamps();
      });
    };
    var initLoaded = function() {
      XHR.get('/rolleicom', {'action': 'queryloaded'}, function(x, r) {
        var success = r.response[0], value = r.response[1], status = r.response[2];
        if (success) {
          lleft.value = value[0];
          lright.value = value[1];
        }
        initDissolve();
      });
    };
    var initBrightness = function() {
      XHR.get('/rolleicom', {'action': 'querybrightness'}, function(x, r) {
        var success = r.response[0], value = r.response[1], status = r.response[2];
        if (success) {
          bright.value = value[1];
          bleft.value = value[0];
          document.getElementById('brightvalue').value = ('\xA0\xA0\xA0\xA0\xA0' + (bright.value / 255 * 100).toFixed(1)).slice(-5);
          document.getElementById('bleftvalue').value = ('\xA0\xA0\xA0\xA0\xA0' + (bleft.value / 255 * 100).toFixed(1)).slice(-5);
        }
        initLoaded();
      });
    };
    var initConnection = function() {
      XHR.get('/rolleicom', {'action': 'connected'}, function(x, r) {
        var response = r.response;
        if (response) {
          document.getElementById('projector_status_online').style.display = '';
          document.getElementById('projector_status_offline').style.display = 'none';
        } else {
          document.getElementById('projector_status_online').style.display = 'none';
          document.getElementById('projector_status_offline').style.display = '';
        }
        initBrightness();
      });
    };

    initConnection();
  };
</script>
<table>
  <tr>
    <td>
      <span id="projector_status" onclick="">
        Projector
        <span id=projector_status_online style=display:none>online</span>
        <span id=projector_status_offline>offline</span>
      </span>
    </td>
    <td>
    </td>
    <td>
      <span id=xhr_poll_status style=display:none onclick="XHR.running() ? XHR.halt() : XHR.run()">
        Auto Refresh:
        <span id=xhr_poll_status_on>on</span>
        <span id=xhr_poll_status_off style="display:none">off</span>
      </span>
    </td>
  </tr>
  <tr>
    <td>
      <button id=stopgo onclick="submit({'action': 'togglestop'}, this)">STOP / GO</button>
    </td>
    <td>
      <button id=forward onclick="submit({'action': 'next'}, this)" class="big positive">▲</button>
    </td>
    <td>
      <button id=focusin onclick="submit({'action': 'focusin'}, this)">FOCUS IN</button>
    </td>
  </tr>
  <tr>
    <td>
      <button id=autofocus onclick="submit({'action': 'toggleAF'}, this)">AUTOFOCUS</button>
    </td>
    <td>
      <button id=back onclick="submit({'action': 'previous'}, this)" class="big positive">▼</button>
    </td>
    <td>
      <button id=focusout onclick="submit({'action': 'focusout'}, this)">FOCUS OUT</button>
    </td>
  </tr>
  <tr>
    <td colspan="3">
      <hr>
    </td>
  </tr>
  <tr>
    <td>
      <span>LEFT</span>
    </td>
    <td>
    </td>
    <td>
      <span>RIGHT</span>
    </td>
  </tr>
  <tr>
    <td>
      <button id=leftlamp onclick="submit({'action': 'toggleleftlamp'}, this)" class=big>
          <svg xmlns="http://www.w3.org/2000/svg" width=40px height=40px viewBox="0 0 16 19">
            <g style="fill:#565656">
            <path d="m8 3c-2.75 0-5 2.25-5 5 0 1.586 0.845 2.9 2 3.81v2.19 1h1 4 1v-1-2.188c1.16-0.91 2-2.224 2-3.81 0-2.75-2.25-5-5-5zm0 2c1.669 0 3 1.331 3 3 0 1.116-0.5951 2.038-1.5 2.562l-0.5 0.32v0.56 1.56h-2v-1.56-0.56l-0.5-0.32c-0.9-0.52-1.5-1.438-1.5-2.558 0-1.668 1.331-3 3-3z"/>
            <path d="m6 18v1h4v-1h-4z"/>
            <path d="m5 16v1h6v-1h-6z"/>
            <path style="opacity:.35" d="m7 8v1h2v-1h-2z"/>
            </g>
            <g class=bulbglow>
            <g style="fill:#ce5c00">
            <path d="m8 3c-2.75 0-5 2.25-5 5 0 1.586 0.845 2.9 2 3.81v2.19 1h1 4 1v-1-2.188c1.16-0.91 2-2.224 2-3.81 0-2.75-2.25-5-5-5zm0 2c1.669 0 3 1.331 3 3 0 1.116-0.5951 2.038-1.5 2.562l-0.5 0.32v0.56 1.56h-2v-1.56-0.56l-0.5-0.32c-0.9-0.52-1.5-1.438-1.5-2.558 0-1.668 1.331-3 3-3z"/>
            <path d="m6 18v1h4v-1h-4z"/>
            <path d="m5 16v1h6v-1h-6z"/>
            <path style="opacity:.35" d="m7 8v1h2v-1h-2z"/>
            </g>
            <g style="fill:#f57900">
            <rect rx=".5625" ry=".5625" height="2" width="2" y="7.031" x=".006833"/>
            <rect rx=".5625" ry=".5625" height="2" width="2" y="7.031" x="14.01"/>
            <rect ry=".5625" rx=".5625" transform="rotate(90)" height="2" width="2" y="-9" x="0"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-12" x="-8"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-12" x="6"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-19" x="-1"/>
            <rect ry=".5625" rx=".5625" transform="rotate(45)" height="2" width="2" y="-.5996" x="3.724"/>
            <path style="opacity:.8" d="m7.109 8.217v1h2v-1h-2z"/>
            </g>
            </g>
          </svg>
      </button>
    </td>
    <td>
      <button id=lamps onclick="toggleLamps(this)" class=big>☀☀</button>
    </td>
    <td>
      <button id=rightlamp onclick="submit({'action': 'togglerightlamp'}, this)" class=big>
          <svg xmlns="http://www.w3.org/2000/svg" width=40px height=40px viewBox="0 0 16 19">
            <g style="fill:#565656">
            <path d="m8 3c-2.75 0-5 2.25-5 5 0 1.586 0.845 2.9 2 3.81v2.19 1h1 4 1v-1-2.188c1.16-0.91 2-2.224 2-3.81 0-2.75-2.25-5-5-5zm0 2c1.669 0 3 1.331 3 3 0 1.116-0.5951 2.038-1.5 2.562l-0.5 0.32v0.56 1.56h-2v-1.56-0.56l-0.5-0.32c-0.9-0.52-1.5-1.438-1.5-2.558 0-1.668 1.331-3 3-3z"/>
            <path d="m6 18v1h4v-1h-4z"/>
            <path d="m5 16v1h6v-1h-6z"/>
            <path style="opacity:.35" d="m7 8v1h2v-1h-2z"/>
            </g>
            <g class=bulbglow>
            <g style="fill:#ce5c00">
            <path d="m8 3c-2.75 0-5 2.25-5 5 0 1.586 0.845 2.9 2 3.81v2.19 1h1 4 1v-1-2.188c1.16-0.91 2-2.224 2-3.81 0-2.75-2.25-5-5-5zm0 2c1.669 0 3 1.331 3 3 0 1.116-0.5951 2.038-1.5 2.562l-0.5 0.32v0.56 1.56h-2v-1.56-0.56l-0.5-0.32c-0.9-0.52-1.5-1.438-1.5-2.558 0-1.668 1.331-3 3-3z"/>
            <path d="m6 18v1h4v-1h-4z"/>
            <path d="m5 16v1h6v-1h-6z"/>
            <path style="opacity:.35" d="m7 8v1h2v-1h-2z"/>
            </g>
            <g style="fill:#f57900">
            <rect rx=".5625" ry=".5625" height="2" width="2" y="7.031" x=".006833"/>
            <rect rx=".5625" ry=".5625" height="2" width="2" y="7.031" x="14.01"/>
            <rect ry=".5625" rx=".5625" transform="rotate(90)" height="2" width="2" y="-9" x="0"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-12" x="-8"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-12" x="6"/>
            <rect ry=".5625" rx=".5625" transform="rotate(135)" height="2" width="2" y="-19" x="-1"/>
            <rect ry=".5625" rx=".5625" transform="rotate(45)" height="2" width="2" y="-.5996" x="3.724"/>
            <path style="opacity:.8" d="m7.109 8.217v1h2v-1h-2z"/>
            </g>
            </g>
          </svg>
      </button>
    </td>
  </tr>
  <tr>
    <td>
      <input id=bleftinput type=range class=mousetrap min=0 max=255 value=255 step=1 onclick="focus()" />
    </td>
    <td>
      <output id=bleftvalue>100.0</output>
      <output id=brightvalue>100.0</output>
    </td>
    <td>
      <input id=brightinput type=range class=mousetrap min=0 max=255 value=255 step=1 onclick="focus()" />
    </td>
  </tr>
  <tr>
    <td>
      <form onsubmit="return formsend(this), false;" action="rolleicom" name=loadleft method="get">
        <input id=lleftinput type=number name=slide min=0 max=50>
        <input type="submit" value="LOAD" />
      </form>
    </td>
    <td>
    </td>
    <td>
      <form onsubmit="return formsend(this), false;" action="rolleicom" name=loadright method="get">
        <input id=lrightinput type=number name=slide min=0 max=50>
        <input type="submit" value="LOAD" />
      </form>
    </td>
  </tr>
  <tr>
    <td colspan=3>
      <hr>
  </tr>
  <tr>
    <td class=right>
      <label for=dissolveinput>DISSOLVE</label>
    </td>
    <td class=centered>
      <input id=dissolveinput type=range class=mousetrap min=0 max=255 value=25 step=1 onclick="focus()" />
    </td>
    <td class=left>
      <output id=dissolvevalue>&nbsp;&nbsp;2.5 Sek.</output>
    </td>
  </tr>
  <tr>
    <td colspan=3>
      <hr>
    </td>
  </tr>
  <tr>
    <td>
      <button id=pcmode onclick="submit({'action': 'togglePC'}, this)">PC MODE</button>
    </td>
    <td>
      <button id=end onclick="submit({'action': 'end'}, this)">END</button>
    </td>
    <td>
      <button onclick="toggleDark()">DARK</button>
    </td>
  </tr>
  <tr>
    <td colspan=3>
      <span id=res></span>
      <span id=error></span>
    </td>
  </tr>
</table>
<div id=shortcuthelp class=hidden>
KEYBOARD SHORTCUTS

<table>
<tbody>
<tr>
<td colspan=2><hr></td>
</tr>
<tr>
<td class=right>1</td>
<td class=left>Left lamp on</td>
</tr>
<tr>
<td class=right>2</td>
<td class=left>Right lamp on</td>
</tr>
<tr>
<td class=right>3</td>
<td class=left>Left lamp off</td>
</tr>
<tr>
<td class=right>4</td>
<td class=left>Right Lamp off</td>
</tr>
<tr>
<td class=right>5</td>
<td class=left>Dissolve lamps left to right</td>
</tr>
<tr>
<td class=right>6</td>
<td class=left>Dissolve lamps right to left</td>
</tr>
<tr>
<td class=right>7</td>
<td class=left>Both lamps on</td>
</tr>
<tr>
<td class=right>8</td>
<td class=left>Both lamps off</td>
</tr>
<tr>
<td colspan=2><hr></td>
</tr>
<tr>
<td class=right>h</td>
<td class=left>Decrease brightness left</td>
</tr>
<tr>
<td class=right>j</td>
<td class=left>Increase brightness left</td>
</tr>
<tr>
<td class=right>k</td>
<td class=left>Decrease brightness right</td>
</tr>
<tr>
<td class=right>l</td>
<td class=left>Increase brightness right</td>
</tr>
<tr>
<td colspan=2><hr></td>
</tr>
<tr>
<td class=right>&lt;</td>
<td class=left>Next slide</td>
</tr>
<tr>
<td class=right>&gt;</td>
<td class=left>Previous slide</td>
</tr>
<tr>
<td class=right>+</td>
<td class=left>Focus in</td>
</tr>
<tr>
<td class=right>-</td>
<td class=left>Focus out</td>
</tr>
<tr>
<td colspan=2><hr></td>
</tr>
<tr>
<td class=right>s</td>
<td class=left>Stop / Go</td>
</tr>
<tr>
<td class=right>p</td>
<td class=left>PC mode</td>
</tr>
<tr>
<td class=right>e</td>
<td class=left>End and rewind</td>
</tr>
<tr>
<td class=right>r</td>
<td class=left>Reset projector</td>
</tr>
</tbody>
</table>
</div>
